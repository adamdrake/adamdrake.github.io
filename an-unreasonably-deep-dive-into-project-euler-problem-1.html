<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="chrome=1">
<meta name=HandheldFriendly content="True">
<meta name=MobileOptimized content="320">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=referrer content="no-referrer">
<meta name=description content="Adam Drake is an advisor to scale-up tech companies. He writes about ML/AI/crypto/data, leadership, and building tech teams.">
<title>
An Unreasonably Deep Dive into Project Euler Problem 1 - Adam Drake
</title>
<link rel="shortcut icon" href=/static/favicon.ico>
<link rel=stylesheet href=https://adamdrake.com/sass/style.min.4b0d3fd52024283b14d542e540f013de2976b7a9ca4436a50d9555c6a678c3be.css integrity="sha256-Sw0/1SAkKDsU1ULlQPAT3il2t6nKRDalDZVVxqZ4w74=" crossorigin=anonymous media=screen>
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://adamdrake.com/static/images/twitter-card.jpg">
<meta name=twitter:title content="An Unreasonably Deep Dive into Project Euler Problem 1">
<meta name=twitter:description content="Introduction As part of my work in keeping my technical skills sharp, I periodically go back to basics or solve old problems again in order to ensure my foundations are strong. So it was with great fun that I decided to start back at the beginning with Project Euler.
One of the techniques I also use for this sort of thing is not just to solve the problem, but to really explore it.">
<meta property="og:title" content="An Unreasonably Deep Dive into Project Euler Problem 1">
<meta property="og:description" content="Introduction As part of my work in keeping my technical skills sharp, I periodically go back to basics or solve old problems again in order to ensure my foundations are strong. So it was with great fun that I decided to start back at the beginning with Project Euler.
One of the techniques I also use for this sort of thing is not just to solve the problem, but to really explore it.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://adamdrake.com/an-unreasonably-deep-dive-into-project-euler-problem-1.html"><meta property="og:image" content="https://adamdrake.com/static/images/twitter-card.jpg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-01-04T00:00:00+00:00">
<meta property="article:modified_time" content="2017-01-04T00:00:00+00:00">
</head>
<body>
<div class=title-box>
<div class=title-left>
<h1 class=name><a href=/>Adam Drake</a></h1>
</div>
<div class=title-right>
<div class=social-icons>
<a href=https://github.com/adamdrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAC5UlEQVR4nO2a0XXiMBBFKYESKIEOlg5CB3EHmw5wB9DBbgebDnAHTgemA9PB3Q8J1mtkaSSPjTnRPYePHIzem/FoJFtZrTKZTCaTyWQmBFgD78ABOAMNjzT2u4O9dv1s36OwQf8EakewUmo7xuskA9gAR6AdEXif1o65eXZ8XjDlqxm4KxGHZ8f5ALBlXKnHUrOUagAKpr3rQ7TAfgnBP5viOwd/Y94ksKzgb8wzHTAN7xlzPkTLHI0Rf7ffdZJUAleFwK52rK0de+e5tp46+NJn1HH92vGbK1DZz6f93P7uJ6zEsQsMJKycKvgN/tKvAr/dIyhRybU2WUNMMxWAUyDzlbrosBdfAvSrAFPKocZXqYr6/YQS0KL5AAV8BAQBWjXBsB/JKlRoCkr2+Q9NcCqQrS46KwKm/CXsVARlnnxLYZfx0wDZru9TIa5YX6E+ABq7Q8LdH2a8+x1fe4GvUkMolOnZ5r7DW6gXVBoizeQi6d5CN6fREAlRjQ8l2VuwD2iI5AR89wRcJhdJ9xbioiEiWW83o4XifW0EvioNIUkCitFC8b4kG7RKQ0iyETqPDyna11ng66QhJNlxwTKfBVS2wtKHoZoZDjGtH+kplI4f4GsJSYgM/ktTOOYcoMa+wdUEU/ZNhI9CU3zN44NHZRPze8DAH+BNQfvNjhWD/gMaj6vB/YQWcw7g2zCdMUfnwcrA3Okjsi4/xPju7zDmqoKWfwcWW8f3XS4I+oPVCe4+PVwlOqlJcL0cvb+Bxd8rPkbqSBHrJIF7Z1gKzIsbI/J1vk81Rcx9c65S/+89PKaM9zYZOxJKMiH4a0ySRzFwh34pa8QyT/Adg675flQcP4ZCSzfWpCsJDWbJ+9H5vCeMvezgO0Z3CE5qEsYNMd+cD4FpjN73Bglj+qgWE3wXTNd3VkPCWEN3fdp1fiyYJfDUT0TCOP3AT7zS/wyvVvcmWZGwN7cB3x64XivwTCaTyWQymVfgL42yxWFGEKJcAAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=https://twitter.com/aadrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACQ0lEQVR4nO2a0XWjMBBFXQIluIR0EDpIOjAdLB1kO0g6sDvIdgAd2B3gDkwHNx8jEkIMNmTGkvfMPUc//hjmPTTSIHm1chzHcRzHcRzHSQggAx6BlzA2wEPsvMwBcqBinCYYkl2I8WyRXKEe9Ct2BmwnhJ8z4mEQ46ln3lo7wTwELlQDrz7F72eI7zgBr8D74Pc37RxXwK73gEI59naB+DEOTJTHb5IcvqFCKW7+U8PvxIex0cqxS/QcW4W4jZL4rhyqvhka2rtEx9izcHsC1krih7RLc5pK9jDxwBMXtqaRmKWB+KO6+JDsvyse3gCbGTH/Kou3WQBDssWMRBrgz6VkDAywER+SzZDamkuFmPFjWqJsgJn4XsIaNVsh+/4L0y3vbMwNCCZcsxZEwVr4K7JtZXzvClOhtTagY49M3VMcnaPU1gZM9QEpsLM24C22wgsU1gZYta1a2J8Wke4sOJqLDwZkpLkW6B+A3JkJtz0sRUxIpRwONxU/MGKNNEXHiAYUMYQ/I81QN2I1Rcebiw8GrFn2ZaiN/tn/DBO0v+XnUkcT3zOhjiS+RfviY6EBGXE+j4vY2r+BHJTcak3YxdZ7FmQ2lMiMsDIj3p4/B+S2p9EWj+WhpwbILBheVGpQJy0e6Qu2BsIh4Zp/RM4Jl1xrX0NLzEanJzRH+v0K/boeI70pj3R+1ltdDeSxtU6CXJFpdoAtMsPu6w9QyMJXsuxz+ICcJ8SvcS2QLTAPo0RKphtl+P2+3rLjOI7jOI7jOP8tH5ahgbeYuZE9AAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=https://linkedin.com/in/aadrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAzElEQVRIie2WWxGDMBBFVwISkIAEnBQJOCoOKqE4AAeNg+Lg9AOY2VmSTls29If7eTPJmbubl8gioAEG/DQAF9ECOkeA1VUnya1GgPEA0CARs2dO2QLBi2RBAShU78pcoF6MgCkH6AlUClJ7QGKgFXYD7l6QFOhbBeYN9Hb3bkCRHqX8CaiNV6aAe0CV9Ra/IHIsfgapRYuIv7lt9iTSi7VmbHP+9oB0eR6peR6gj+adoBP0X9ART/l43OdkiZnzu9XZmjb4lnFkTSIiLyov4WUSpGLDAAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=/index.xml>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAABOElEQVRIib2WXXWEMBBGIyESkICDroPWQSNhHRQnrANwsOsAHFAJdXD7ALSz0wmZLrTfObwwkDs/X3ISwiIgAQPHaQBegxRwORCg1cpK/lopAKN6eQEaoAduwPsBoCFoSDAEVMDZSMotF0hBT8yV7gIBtMAb8Aw8ATEDTMDHHpClDm3VGVbjbKcXtGrSQCB6YL8FreoQLfXALJC099bPg4LVbMys6DpmazdOWHbzu+29AK0KO/Wdaf2SvaNaJGKfi0ntMxfIApcGP6mEflTudd0E1KqNWrKq86OgFSYr0wbplQMfBoEwC3ZVMpG7U98C3ZZFKmwHZRcDTjn3WaCqkPWLiPfemAWKBVCzMadszAJd+W7d1YjLOek9lY2ZnneoXR5vbPy/y0mmBUfqq50rLLHj8mFoRJwWnzknvtUm1yWnAAAAAElFTkSuQmCC width=64 height=64>
</a>
</div>
<button class="subscribe subscribe-btn">
<a href=https://www.digitalmaneuver.com/#/portal>Subscribe to my newsletter</a>
</button>
</div>
</div>
<div class="nav-box row">
<div class=nav-left-menu>
<ul>
<li><a href=/>Latest</a> | </li>
<li><a href=/about.html>About</a> | </li>
<li><a href=/cases.html>Case Studies</a> | </li>
<li><a href=/contact.html>Contact</a> | </li>
<li><a href=/press.html>Press</a></li>
</ul>
</div>
</div>
<section class=section>
<div class=container>
<a href=https://applybyapi.com><button class=btn>Struggling to hire developers? Check out ApplyByAPI!</button></a>
<h1 class=page-title>An Unreasonably Deep Dive into Project Euler Problem 1</h1>
<h2 class=content-date>January 4, 2017</h2>
<div class=share-links>
Share this:
<a class=twitter-share-button href="https://twitter.com/intent/tweet?text=Read%20An%20Unreasonably%20Deep%20Dive%20into%20Project%20Euler%20Problem%201%20https%3a%2f%2fadamdrake.com%2fan-unreasonably-deep-dive-into-project-euler-problem-1.html" onclick="return window.open(this.href,'twitter-share','width=550,height=235'),!1">
twitter
</a> //
<a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fadamdrake.com%2fan-unreasonably-deep-dive-into-project-euler-problem-1.html" onclick="return window.open(this.href,'facebook-share','width=580,height=296'),!1">
facebook
</a> //
<a class=icon-linkedin href="https://www.linkedin.com/shareArticle?mini=true&url=https://adamdrake.com&title=An%20Unreasonably%20Deep%20Dive%20into%20Project%20Euler%20Problem%201&source=Adam%20Drake" onclick="return window.open(this.href,'linkedin-share','width=980,height=980'),!1">
linkedin
</a>
</div>
<div class=content>
<h1 id=introduction class=anchor-link><a href=#introduction>Introduction</a></h1>
<p>As part of my work in keeping my technical skills sharp, I periodically go back to basics or solve old problems again in order to ensure my foundations are strong. So it was with great fun that I decided to start back at the beginning with <a href=https://projecteuler.net>Project Euler</a>.</p>
<p>One of the techniques I also use for this sort of thing is not just to solve the problem, but to really explore it. Write additional code, tests, benchmarks, and explore the underlying mathematics where practical.</p>
<p>With that in mind, here is a deep dive into <a href="https://projecteuler.net/problem=1">Project Euler - Problem 1</a>.</p>
<h1 id=overview class=anchor-link><a href=#overview>Overview</a></h1>
<p>The problem is short and easy to understand:</p>
<blockquote>
<p>If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23. Find the sum of all the multiples of 3 or 5 below 1000.</p>
</blockquote>
<p>A simple brute-force approach to this is simply to iterate through all of the numbers from 1 to 999 (since we are only to check numbers below 1000), check if the number is divisible by 3 or 5, and sum the ones which are.</p>
<p>If you want the Python one-liner:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python><span style=color:#366>sum</span>([x <span style=color:#069;font-weight:700>for</span> x <span style=color:#000;font-weight:700>in</span> <span style=color:#366>range</span>(<span style=color:#f60>1000</span>) <span style=color:#069;font-weight:700>if</span> ((x <span style=color:#555>%</span> <span style=color:#f60>5</span> <span style=color:#555>==</span> <span style=color:#f60>0</span>) <span style=color:#000;font-weight:700>or</span> (x <span style=color:#555>%</span> <span style=color:#f60>3</span> <span style=color:#555>==</span> <span style=color:#f60>0</span>))])
</code></pre></div><p>Of if you are using Go, as I was:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>bruteForce</span>(limit <span style=color:#078;font-weight:700>int</span>) <span style=color:#078;font-weight:700>int</span> {
	total <span style=color:#555>:=</span> <span style=color:#f60>0</span>
	<span style=color:#069;font-weight:700>for</span> i <span style=color:#555>:=</span> <span style=color:#f60>0</span>; i <span style=color:#555>&lt;=</span> limit; i<span style=color:#555>++</span> {
		<span style=color:#069;font-weight:700>if</span> math.<span style=color:#c0f>Mod</span>(<span style=color:#366>float64</span>(i), <span style=color:#f60>5</span>) <span style=color:#555>==</span> <span style=color:#f60>0</span> <span style=color:#555>||</span> math.<span style=color:#c0f>Mod</span>(<span style=color:#366>float64</span>(i), <span style=color:#f60>3</span>) <span style=color:#555>==</span> <span style=color:#f60>0</span> {
			total <span style=color:#555>+=</span> i
		}
	}
	<span style=color:#069;font-weight:700>return</span> total
}
</code></pre></div>
<h1 id=does-it-work class=anchor-link><a href=#does-it-work>Does it work?</a></h1>
<p>This works fine and both produce the required answer of 233168, which we can verify with some tests in Go:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>TestBruteForce</span>(t <span style=color:#555>*</span>testing.T) {
	<span style=color:#069;font-weight:700>if</span> <span style=color:#c0f>bruteForce</span>(<span style=color:#f60>9</span>) <span style=color:#555>!=</span> <span style=color:#f60>23</span> {
		t.<span style=color:#c0f>Fatal</span>(<span style=color:#c30>&#34;The sum of values from 1 to 10 which are divisible by 5 and 3 should be 23&#34;</span>)
	}
	<span style=color:#069;font-weight:700>if</span> <span style=color:#c0f>bruteForce</span>(<span style=color:#f60>999</span>) <span style=color:#555>!=</span> <span style=color:#f60>233168</span> {
		t.<span style=color:#c0f>Fatal</span>(<span style=color:#c30>&#34;The sum of values from 1 to 1000 which are divisible by 5 and 3 should be 233168&#34;</span>)
	}
}
</code></pre></div><p>And we can run the tests to ensure that everything passes and is working normally.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -v
<span style=color:#555>===</span> RUN   TestBruteForce
--- PASS: TestBruteForce <span style=color:#555>(</span>0.00s<span style=color:#555>)</span>
PASS
ok      _path/...     0.008s
</code></pre></div>
<h1 id=how-fast-is-it class=anchor-link><a href=#how-fast-is-it>How fast is it?</a></h1>
<p>This is enough for a working solution, and it isn&rsquo;t too slow, but it&rsquo;s not great as we can see by the built-in benchmark capabilities in Go.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>BenchmarkBruteForce</span>(b <span style=color:#555>*</span>testing.B) {
	<span style=color:#069;font-weight:700>for</span> i <span style=color:#555>:=</span> <span style=color:#f60>0</span>; i &lt; b.N; i<span style=color:#555>++</span> {
		<span style=color:#c0f>bruteForce</span>(<span style=color:#f60>999</span>)
	}
}
</code></pre></div><p>A benchmark function takes a <code>*testing.B</code> and iterates up to <code>b.N</code>, which is a number defined by the package and dependent on the stability of the timing of your function call, and produces output telling you how many times the function was run in order to perform the benchmark provide the required execution time per call.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -bench .
BenchmarkBruteForce-4              <span style=color:#f60>10000</span>            <span style=color:#f60>227761</span> ns/op
</code></pre></div><p>So our brute force approach took 10000 iterations to settle on a timing of 227,761 nanoseconds per operation.</p>
<p>Now we have not only solved the problem, but added tests and benchmarks. Perhaps a bit more effort than some people put into Project Euler, but not bad. However, this solution is still linear in the number of elements we have to check. In other words, if we wanted to check the numbers up to 1,000,000 instead of only up to 1,000 then the solution would take much longer to run. This solution is O(n) which isn&rsquo;t bad, but isn&rsquo;t great either. We check the increase in runtime by simply modifying the argument in our benchmark function.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>BenchmarkBruteForce</span>(b <span style=color:#555>*</span>testing.B) {
	<span style=color:#069;font-weight:700>for</span> i <span style=color:#555>:=</span> <span style=color:#f60>0</span>; i &lt; b.N; i<span style=color:#555>++</span> {
		<span style=color:#c0f>bruteForce</span>(<span style=color:#f60>1000000</span>)
	}
}
</code></pre></div><p>Now we will have different timing and benchmark information.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -bench .
BenchmarkBruteForce-4                  <span style=color:#f60>3</span>         <span style=color:#f60>441286594</span> ns/op
</code></pre></div><p>So by increasing the numbers we have to check by a factor of 1000, we now have a runtime of 441,286,594 ns/op instead of 227,761 ns/op, which is an increase of about 1900x. Not good. For more on asymptotic analysis of runtime, check out the Wikipedia article on <a href=https://en.wikipedia.org/wiki/Big_O_notation>Big O Notation</a>.</p>
<h1 id=performance-upgrades class=anchor-link><a href=#performance-upgrades>Performance upgrades</a></h1>
<p>There are some options to improve the performance, like splitting the range of numbers into parts and spawning multiple worker threads to check each part, thereby parallelizing the work. This is a lot of complexity though, especially when you want to make sure that ranges checked don&rsquo;t overlap, managing potential shared state, and so on. If we think a bit more about the problem, there is a better way.</p>
<p>We want to sum all the multiples of 3 or 5 less than 1000. We can think about the sequence of multiples of 3 as (3, 6, 9, 12, 15, &mldr;, 999), which is the same as 3 * (1, 2, 3, 4, 5, &mldr;, 333). We can do the same for the case of multiples of 5. The benefit of considering the problem in this way is that the list of numbers has a closed-form solution (i.e., a formula) for calculating the sum.</p>
<p>Such a sequence, where the difference between each number is constant, is called a <a href=https://en.wikipedia.org/wiki/Arithmetic_progression>finite arithmetic progression</a> or finite arithmetic sequence and the sum of a finite arithmetic progression is called a finite arithmetic series. The formula for the sum is <code>1/2 * n * (a_1 + a_n)</code>. where <code>n</code> is the number of terms being added, <code>a_1</code> is the first element in the sequence, and <code>a_n</code> is the last element in the sequence.</p>
<p>From our example for multiples of 3, we know that <code>a_1 = 1</code> and we know that <code>a_n = floor(999/3) = 333</code> and we also know that the total number of elements in the sequence will be <code>n = floor(999/3) = 333 = a_n</code>. So for our purposes, the sum of our sequences is equal to <code>n * (n + 1) * 0.5</code>. We can make a small helper function to calculate this for us.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>arithSum</span>(n <span style=color:#078;font-weight:700>float64</span>) <span style=color:#078;font-weight:700>float64</span> {
	<span style=color:#069;font-weight:700>return</span> (n <span style=color:#555>*</span> (n <span style=color:#555>+</span> <span style=color:#f60>1</span>)) <span style=color:#555>/</span> <span style=color:#f60>2</span>
}
</code></pre></div><p>Now we can simply compute the sum of the arithmetic sequence for all the multiples of 3 and 5 without iterating through anything at all. Since we already know the answers to the questions from the brute force case, we can also write the appropriate tests.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>TestArithSeq</span>(t <span style=color:#555>*</span>testing.T) {
	<span style=color:#069;font-weight:700>if</span> <span style=color:#c0f>arithSeq</span>(<span style=color:#f60>9</span>) <span style=color:#555>!=</span> <span style=color:#f60>23</span> {
		t.<span style=color:#c0f>Fatal</span>(<span style=color:#c30>&#34;The sum of values from 1 to 10 which are divisible by 5 and 3 should be 23&#34;</span>)
	}
	<span style=color:#069;font-weight:700>if</span> <span style=color:#c0f>arithSeq</span>(<span style=color:#f60>999</span>) <span style=color:#555>!=</span> <span style=color:#f60>233168</span> {
		t.<span style=color:#c0f>Fatal</span>(<span style=color:#c30>&#34;The sum of values from 1 to 1000 which are divisible by 5 and 3 should be 233168&#34;</span>)
	}
}
</code></pre></div><p>For the corresponding function:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>arithSeq</span>(limit <span style=color:#078;font-weight:700>float64</span>) <span style=color:#078;font-weight:700>int</span> {
	threes <span style=color:#555>:=</span> <span style=color:#f60>3</span> <span style=color:#555>*</span> <span style=color:#c0f>arithSum</span>(math.<span style=color:#c0f>Floor</span>((limit)<span style=color:#555>/</span><span style=color:#f60>3</span>))
	fives <span style=color:#555>:=</span> <span style=color:#f60>5</span> <span style=color:#555>*</span> <span style=color:#c0f>arithSum</span>(math.<span style=color:#c0f>Floor</span>((limit)<span style=color:#555>/</span><span style=color:#f60>5</span>))
	<span style=color:#069;font-weight:700>return</span> <span style=color:#366>int</span>(threes <span style=color:#555>+</span> fives)
}
</code></pre></div><p>But there is a problem because not all of our tests pass.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -v
<span style=color:#555>===</span> RUN   TestArithSeq
--- FAIL: TestArithSeq <span style=color:#555>(</span>0.00s<span style=color:#555>)</span>
		0001_test.go:10: The sum of values from <span style=color:#f60>1</span> to <span style=color:#f60>1000</span> which are divisible by <span style=color:#f60>5</span> and <span style=color:#f60>3</span> should be <span style=color:#033>233168</span>
<span style=color:#555>===</span> RUN   TestBruteForce
--- PASS: TestBruteForce <span style=color:#555>(</span>0.00s<span style=color:#555>)</span>
FAIL
<span style=color:#366>exit</span> status <span style=color:#f60>1</span>
</code></pre></div><p>What is the problem? Why did the test for <code>n = 9</code> pass but the test for <code>n = 999</code> fail? The answer starts at 15, which is divisible by both 5 <strong>and</strong> 3. Because we summed all the multiple of 5, and all the multiples of 3, we also summed all the multiples of 15. In other words, all the multiples of 15 are double counted because we need them to be summed as a multiple of 5, or as a multiple of 3, but not both. This a common problem in combinatorics, the study of finite or countable discrete structures, and the answer is easily described by the <a href=https://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle>inclusion-exclusion principle</a>.</p>
<p>For some set <code>A</code>, like the set of all multiples of 3, and some set <code>B</code>, like the set of all multiples of 5, then when we add them we have to subtract their interaction because it is counted twice. In our case, this intersection is the set of all multiples of 15. So we can get the correct solution by simply removing the sum of all multiples of 15 from our total.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>arithSeq</span>(limit <span style=color:#078;font-weight:700>float64</span>) <span style=color:#078;font-weight:700>int</span> {
	threes <span style=color:#555>:=</span> <span style=color:#f60>3</span> <span style=color:#555>*</span> <span style=color:#c0f>arithSum</span>(math.<span style=color:#c0f>Floor</span>(limit<span style=color:#555>-/</span><span style=color:#f60>3</span>))
	fives <span style=color:#555>:=</span> <span style=color:#f60>5</span> <span style=color:#555>*</span> <span style=color:#c0f>arithSum</span>(math.<span style=color:#c0f>Floor</span>(limit<span style=color:#555>/</span><span style=color:#f60>5</span>))
	fifteens <span style=color:#555>:=</span> <span style=color:#f60>15</span> <span style=color:#555>*</span> <span style=color:#c0f>arithSum</span>(math.<span style=color:#c0f>Floor</span>(limit<span style=color:#555>/</span><span style=color:#f60>15</span>))
	<span style=color:#069;font-weight:700>return</span> <span style=color:#366>int</span>(threes <span style=color:#555>+</span> fives <span style=color:#555>-</span> fifteens)
}
</code></pre></div><p>Now all of our tests will pass.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -v
<span style=color:#555>===</span> RUN   TestArithSeq
--- PASS: TestArithSeq <span style=color:#555>(</span>0.00s<span style=color:#555>)</span>
<span style=color:#555>===</span> RUN   TestBruteForce
--- PASS: TestBruteForce <span style=color:#555>(</span>0.00s<span style=color:#555>)</span>
PASS
</code></pre></div><p>Ok, great. Now we have another way of solving the problem, but what was the actual speed benefit? It&rsquo;s pretty dramatic. First, we need to add a benchmark function to our <code>_test.go</code> file:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#069;font-weight:700>func</span> <span style=color:#c0f>BenchmarkArithSeq</span>(b <span style=color:#555>*</span>testing.B) {
	<span style=color:#069;font-weight:700>for</span> i <span style=color:#555>:=</span> <span style=color:#f60>0</span>; i &lt; b.N; i<span style=color:#555>++</span> {
		<span style=color:#c0f>arithSeq</span>(<span style=color:#f60>999</span>)
	}
}
</code></pre></div><p>Now we can see the difference.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go <span style=color:#366>test</span> -bench .
BenchmarkBruteForce-4              <span style=color:#f60>10000</span>            <span style=color:#f60>227689</span> ns/op
BenchmarkArithSeq-4             <span style=color:#f60>100000000</span>               21.8 ns/op
PASS
</code></pre></div><p>Both of those are for the specified Project Euler problem of summing only the multiples below 1000. In this case, the solution using the arithmetic series approach is about 10,000 times faster than the brute-force approach.</p>
<p>Better still, because the arithmetic series approach requires the same number of operations regardless of the input size, it doesn&rsquo;t matter if we want to do the summation for multiples up to 1000 or 1,000,000 it will always take the same amount of processing time. So the arithmetic series approach is constant time (also denoted O(1)). Much better.</p>
<p>There are probably other interesting ways to solve this problem, like finding the prime factors of all the numbers less than <code>n</code> to see if 3 or 5 is one of the factors, but I think this is enough for now.</p>
</div>
</div>
</section>
<div class="nav-box row">
<div class=nav-left-menu>
<ul>
<li><a href=/>Latest</a> | </li>
<li><a href=/about.html>About</a> | </li>
<li><a href=/cases.html>Case Studies</a> | </li>
<li><a href=/contact.html>Contact</a> | </li>
<li><a href=/press.html>Press</a></li>
</ul>
</div>
</div>
<div class="footer-box row">
<div class="footer-left col-md-6 col-xs-12">
<div class="footer-bio content">
<p><strong>Adam Drake</strong> leads technical business transformations in global and multi-cultural environments. He has a passion for helping companies become more productive by improving internal leadership capabilities, and accelerating product development through technology and data architecture guidance. Adam has served as a White House Presidential Innovation Fellow and is an IEEE Senior Member.</p>
</div>
</div>
<div class=footer-right>
<div class=social-icons>
<a href=https://github.com/adamdrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAC5UlEQVR4nO2a0XXiMBBFKYESKIEOlg5CB3EHmw5wB9DBbgebDnAHTgemA9PB3Q8J1mtkaSSPjTnRPYePHIzem/FoJFtZrTKZTCaTyWQmBFgD78ABOAMNjzT2u4O9dv1s36OwQf8EakewUmo7xuskA9gAR6AdEXif1o65eXZ8XjDlqxm4KxGHZ8f5ALBlXKnHUrOUagAKpr3rQ7TAfgnBP5viOwd/Y94ksKzgb8wzHTAN7xlzPkTLHI0Rf7ffdZJUAleFwK52rK0de+e5tp46+NJn1HH92vGbK1DZz6f93P7uJ6zEsQsMJKycKvgN/tKvAr/dIyhRybU2WUNMMxWAUyDzlbrosBdfAvSrAFPKocZXqYr6/YQS0KL5AAV8BAQBWjXBsB/JKlRoCkr2+Q9NcCqQrS46KwKm/CXsVARlnnxLYZfx0wDZru9TIa5YX6E+ABq7Q8LdH2a8+x1fe4GvUkMolOnZ5r7DW6gXVBoizeQi6d5CN6fREAlRjQ8l2VuwD2iI5AR89wRcJhdJ9xbioiEiWW83o4XifW0EvioNIUkCitFC8b4kG7RKQ0iyETqPDyna11ng66QhJNlxwTKfBVS2wtKHoZoZDjGtH+kplI4f4GsJSYgM/ktTOOYcoMa+wdUEU/ZNhI9CU3zN44NHZRPze8DAH+BNQfvNjhWD/gMaj6vB/YQWcw7g2zCdMUfnwcrA3Okjsi4/xPju7zDmqoKWfwcWW8f3XS4I+oPVCe4+PVwlOqlJcL0cvb+Bxd8rPkbqSBHrJIF7Z1gKzIsbI/J1vk81Rcx9c65S/+89PKaM9zYZOxJKMiH4a0ySRzFwh34pa8QyT/Adg675flQcP4ZCSzfWpCsJDWbJ+9H5vCeMvezgO0Z3CE5qEsYNMd+cD4FpjN73Bglj+qgWE3wXTNd3VkPCWEN3fdp1fiyYJfDUT0TCOP3AT7zS/wyvVvcmWZGwN7cB3x64XivwTCaTyWQymVfgL42yxWFGEKJcAAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=https://twitter.com/aadrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACQ0lEQVR4nO2a0XWjMBBFXQIluIR0EDpIOjAdLB1kO0g6sDvIdgAd2B3gDkwHNx8jEkIMNmTGkvfMPUc//hjmPTTSIHm1chzHcRzHcRzHSQggAx6BlzA2wEPsvMwBcqBinCYYkl2I8WyRXKEe9Ct2BmwnhJ8z4mEQ46ln3lo7wTwELlQDrz7F72eI7zgBr8D74Pc37RxXwK73gEI59naB+DEOTJTHb5IcvqFCKW7+U8PvxIex0cqxS/QcW4W4jZL4rhyqvhka2rtEx9izcHsC1krih7RLc5pK9jDxwBMXtqaRmKWB+KO6+JDsvyse3gCbGTH/Kou3WQBDssWMRBrgz6VkDAywER+SzZDamkuFmPFjWqJsgJn4XsIaNVsh+/4L0y3vbMwNCCZcsxZEwVr4K7JtZXzvClOhtTagY49M3VMcnaPU1gZM9QEpsLM24C22wgsU1gZYta1a2J8Wke4sOJqLDwZkpLkW6B+A3JkJtz0sRUxIpRwONxU/MGKNNEXHiAYUMYQ/I81QN2I1Rcebiw8GrFn2ZaiN/tn/DBO0v+XnUkcT3zOhjiS+RfviY6EBGXE+j4vY2r+BHJTcak3YxdZ7FmQ2lMiMsDIj3p4/B+S2p9EWj+WhpwbILBheVGpQJy0e6Qu2BsIh4Zp/RM4Jl1xrX0NLzEanJzRH+v0K/boeI70pj3R+1ltdDeSxtU6CXJFpdoAtMsPu6w9QyMJXsuxz+ICcJ8SvcS2QLTAPo0RKphtl+P2+3rLjOI7jOI7jOP8tH5ahgbeYuZE9AAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=https://linkedin.com/in/aadrake>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAzElEQVRIie2WWxGDMBBFVwISkIAEnBQJOCoOKqE4AAeNg+Lg9AOY2VmSTls29If7eTPJmbubl8gioAEG/DQAF9ECOkeA1VUnya1GgPEA0CARs2dO2QLBi2RBAShU78pcoF6MgCkH6AlUClJ7QGKgFXYD7l6QFOhbBeYN9Hb3bkCRHqX8CaiNV6aAe0CV9Ra/IHIsfgapRYuIv7lt9iTSi7VmbHP+9oB0eR6peR6gj+adoBP0X9ART/l43OdkiZnzu9XZmjb4lnFkTSIiLyov4WUSpGLDAAAAAElFTkSuQmCC width=64 height=64>
</a>
<a href=/index.xml>
<img class=icon src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAABOElEQVRIib2WXXWEMBBGIyESkICDroPWQSNhHRQnrANwsOsAHFAJdXD7ALSz0wmZLrTfObwwkDs/X3ISwiIgAQPHaQBegxRwORCg1cpK/lopAKN6eQEaoAduwPsBoCFoSDAEVMDZSMotF0hBT8yV7gIBtMAb8Aw8ATEDTMDHHpClDm3VGVbjbKcXtGrSQCB6YL8FreoQLfXALJC099bPg4LVbMys6DpmazdOWHbzu+29AK0KO/Wdaf2SvaNaJGKfi0ntMxfIApcGP6mEflTudd0E1KqNWrKq86OgFSYr0wbplQMfBoEwC3ZVMpG7U98C3ZZFKmwHZRcDTjn3WaCqkPWLiPfemAWKBVCzMadszAJd+W7d1YjLOek9lY2ZnneoXR5vbPy/y0mmBUfqq50rLLHj8mFoRJwWnzknvtUm1yWnAAAAAElFTkSuQmCC width=64 height=64>
</a>
</div>
<button class="subscribe subscribe-btn">
<a href=https://www.digitalmaneuver.com/#/portal>Subscribe to my newsletter</a>
</button>
</div>
</div>
<div class="container has-text-centered footer-copyright">
</div>
</body>